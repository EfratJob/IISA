<div class="registration-container">
  <mat-card class="registration-card">
    <mat-card-header>
      <div class="header-content">
        <div class="header-text">
          <mat-card-title>Register for the first Israeli space flight</mat-card-title>
        </div>
      </div>
    </mat-card-header>

    <mat-card-content>
      <div *ngIf="isEditMode()" class="edit-notification">
        <mat-icon>edit</mat-icon>
        <span>You edit your details. You can edit up to 3 days after submitting the form.</span>
      </div>

      <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()" class="registration-form">

        <div class="form-section">
          <h3>Personal details</h3>

          <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
<mat-label>Full name</mat-label> <input matInput formControlName="fullName" placeholder="Enter full name">              <mat-error *ngIf="registrationForm.get('fullName')?.hasError('required')">
                Full name is required </mat-error>
              <mat-error *ngIf="registrationForm.get('fullName')?.hasError('minlength')">
                Full name must contain at least 2 characters. </mat-error>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Email address</mat-label> <input matInput formControlName="email" type="email">
              <mat-error *ngIf="registrationForm.get('email')?.hasError('required')">
                Email is required
              </mat-error>
              <mat-error *ngIf="registrationForm.get('email')?.hasError('pattern')">
                Invalid email address
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Phone Number</mat-label>
              <input matInput formControlName="phoneNumber">
              <mat-error *ngIf="registrationForm.get('phoneNumber')?.hasError('required')">
                Phone Number is Required
              </mat-error>
              <mat-error *ngIf="registrationForm.get('phoneNumber')?.hasError('pattern')">
                Invalid Phone Number
              </mat-error>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Age</mat-label>
              <input matInput formControlName="age" type="number" placeholder="25">
              <mat-error *ngIf="registrationForm.get('age')?.hasError('required')">
                Age is required
              </mat-error>
              <mat-error *ngIf="registrationForm.get('age')?.hasError('min')">
                Minimum age 18
              </mat-error>
              <mat-error *ngIf="registrationForm.get('age')?.hasError('max')">
                Maximum age 80
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
              <mat-label>City</mat-label>
              <input matInput formControlName="city">
              <mat-error *ngIf="registrationForm.get('city')?.hasError('required')">
                City is required
              </mat-error>
            </mat-form-field>
          </div>
        </div>

        <div class="form-section">
          <h3>More information</h3>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Hobbies</mat-label>
            <textarea matInput formControlName="hobbies" rows="3"
              placeholder="Tell me about your hobbies..."></textarea>
            <mat-error *ngIf="registrationForm.get('hobbies')?.hasError('required')">
              Hobbies are required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Why I am the perfect candidate</mat-label>
            <textarea matInput formControlName="whyPerfectCandidate" rows="4"
              placeholder="Explain why you think you are the perfect candidate for space flight..."></textarea>
            <mat-error *ngIf="registrationForm.get('whyPerfectCandidate')?.hasError('required')">
              Explanation is required
            </mat-error>
            <mat-error *ngIf="registrationForm.get('whyPerfectCandidate')?.hasError('minlength')">
              Explanation must be at least 20 characters long
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-section">
          <h3>Profile picture</h3>
          <div class="image-upload-container">
            <input #fileInput type="file" accept="image/jpeg,image/png" (change)="onFileSelected($event)" hidden>

            <div *ngIf="!selectedImagePreview()" class="upload-placeholder" (click)="fileInput.click()">
              <mat-icon class="upload-icon">cloud_upload</mat-icon>
              <p>Click to upload image</p>
              <small>JPEG or PNG only</small>
            </div>

            <div *ngIf="selectedImagePreview()" class="image-preview">
              <img [src]="selectedImagePreview()" alt="Profile Picture">
              <button mat-icon-button type="button" (click)="removeImage()" class="remove-image-btn">
                <mat-icon>close</mat-icon>
              </button>
              <button mat-stroked-button type="button" (click)="fileInput.click()" class="change-image-btn">
                Change Image
              </button>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button mat-raised-button color="primary" type="submit" [disabled]="!registrationForm.valid || isLoading()"
            class="submit-btn">
            <mat-spinner *ngIf="isLoading()" diameter="20"></mat-spinner>
            <mat-icon *ngIf="!isLoading()">rocket_launch</mat-icon>
            {{ isEditMode() ? 'Update details' : 'Register for flight' }}
          </button>
          <button *ngIf="!isEditMode()" mat-button type="button" (click)="cancel()">
            Cancel
          </button>
          <button *ngIf="isEditMode()" mat-button type="button" (click)="deleteCandidate()" class="cancel-btn">
            Delete
          </button>
          <button *ngIf="isEditMode()" mat-stroked-button routerLink="/home">
            <mat-icon>arrow_back</mat-icon>
            Back to list
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>